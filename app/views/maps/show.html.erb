<head class="map">
  <script type="application/json" id="bootstrapped_restaurants_json">
    <%= @restaurants.to_json.html_safe %>
  </script>

  <%= render "map", restaurants: @restaurants, restaurant: @restaurants.first %>

</head>

<h1><%= @map.title %></h1>

<body class="map">
  <p><%= @map.description %> |
    <%=pluralize(@map.favorites.count, 'Like')%> |

  <% if @map.owner == current_user%>
    <%= link_to "Edit Map", edit_map_url(@map) %> |
    <%= link_to "Delete Map", map_url(@map), :method => :delete, :class => "delete",
      :confirm => "Are you sure you want to delete this map?" %>
  <% else %>

    <% if @favorite%>
      <%= link_to "Like this Map", map_favorites_url(@map), method: :post %>

    <% else %>
      <%= link_to "Unlike this Map", map_favorite_url(@map), method: :delete %>

    <% end %>
  <% end %>
  </p>

  <div id="map-canvas"></div>

  <section class="restaurant-list">
  </section>

  <section class="comment-new-form"></section
  <section class="comment"></section>

  <script type="application/javascript">
    $(function () {
      <%= @restaurants.to_json.html_safe %>
      var restaurants = JSON.parse($("#bootstrapped_restaurants_json").html());
      window.BellyGuide.initialize($(".restaurant-list"), restaurants, <%= @map.id %>);
    });
  </script>

</body>

<!-- Use ajax without backbone to add comments. in the comment form,
form <id="whatever" data-remote="true">. on the page have a script:
  <script>
  $(document).ready(function() { //what does this do to backbone?
    $(".comment-new-form").on("ajax.success", function(event, data){
      $(".comment").append(data);
      var $form = $(this);
      $form[0].reset
    })
  })
  </script>
In the comment controller:
  def create
  if request.xhr?
    render partial: "comments", locals: {comment: @comment }
  else
    redirect_to wherever
  end
end
Make a _comment.html.erb to render each comment. on the show page:
render partial: "comments", collection: @comments
Check jonathan's personal github, cat ajax branch ujs-->

