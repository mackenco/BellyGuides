<meta name="viewport" content="initial-scale=1.0, user-scalable=no">

<script type="text/javascript"
 src="https://maps.googleapis.com/maps/api/js?key=<%=ENV['GOOGLE_API_KEY'] %>&sensor=false">
</script>

<script type="text/javascript">
  function initialize() {

    var mapOptions = {
      center: new google.maps.LatLng(<%=lat ? lat : 40.7577%>,
        <%=long ? long : -73.9857%>),
      zoom: <%=zoom%>,
      mapTypeId: google.maps.MapTypeId.TERRAIN
    };
    var map = new google.maps.Map(document.getElementById("map-canvas"),
        mapOptions);

    <% restaurants.each do |restaurant| %>
      var marker = new google.maps.Marker({
        position: new google.maps.LatLng(<%= restaurant.latitude %>, <%= restaurant.longitude %>),
        map: map,
        title: "<%= restaurant.name %>"
      });
    <% end %>
  }
  google.maps.event.addDomListener(window, 'load', initialize);

</script>